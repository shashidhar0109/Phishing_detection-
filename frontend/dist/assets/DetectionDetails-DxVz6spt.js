import{j as e}from"./index-Cu6ENgEm.js";import{r as a}from"./vendor-BKU87Gzz.js";import{j as c,g as x}from"./api-C7L67YgP.js";import{R as o}from"./RiskBadge-q8xUSvnq.js";import{c as h,b as g}from"./router-S2BREDmH.js";import{m as j,A as f,b as y,n as N,o as u,p}from"./icons-D5GPftki.js";import{b}from"./utils-yGI3YnzF.js";function U(){const{id:i}=h(),d=g(),[s,l]=a.useState(null),[n,r]=a.useState(!0);a.useEffect(()=>{m()},[i]);const m=async()=>{try{const t=await c(i);l(t.data),r(!1)}catch(t){console.error("Failed to load detection:",t),r(!1)}};return n?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("button",{onClick:()=>d("/"),className:"flex items-center text-sm text-gray-500 hover:text-gray-700 mb-4",children:[e.jsx(j,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"h-8 w-8 text-danger-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.phishing_domain})]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Detected ",b(new Date(s.detected_at),{addSuffix:!0})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(o,{level:s.risk_level,score:s.risk_score})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Domain Information"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Legitimate Domain"}),e.jsxs("dd",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(y,{className:"h-4 w-4 text-success-500 mr-1"}),s.legitimate_domain||"Unknown"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Organization"}),e.jsx("dd",{className:"text-sm text-gray-900",children:s.organization_name||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Variation Type"}),e.jsx("dd",{className:"text-sm text-gray-900",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs",children:s.variation_type})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Domain Created"}),e.jsxs("dd",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(N,{className:"h-4 w-4 mr-1 text-gray-400"}),s.domain_created_at?new Date(s.domain_created_at).toLocaleDateString():"Unknown"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Registrar"}),e.jsx("dd",{className:"text-sm text-gray-900",children:s.registrar||"Unknown"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Network Information"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"IP Address"}),e.jsxs("dd",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(u,{className:"h-4 w-4 mr-1 text-gray-400"}),s.ip_address||"Unknown"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Country"}),e.jsxs("dd",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(p,{className:"h-4 w-4 mr-1 text-gray-400"}),s.country||"Unknown"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"ASN"}),e.jsx("dd",{className:"text-sm text-gray-900",children:s.asn||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"SSL Issuer"}),e.jsx("dd",{className:"text-sm text-gray-900",children:s.ssl_issuer||"None"})]}),s.mx_records&&s.mx_records.length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"MX Records"}),e.jsxs("dd",{className:"text-sm text-gray-900",children:[s.mx_records.length," record(s)"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Analysis Results"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Visual Similarity"}),e.jsx("dd",{className:"text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full",style:{width:`${s.visual_similarity_score}%`}})}),e.jsxs("span",{className:"font-medium",children:[Math.round(s.visual_similarity_score),"%"]})]})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Content Similarity"}),e.jsx("dd",{className:"text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full",style:{width:`${s.content_similarity_score}%`}})}),e.jsxs("span",{className:"font-medium",children:[Math.round(s.content_similarity_score),"%"]})]})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Login Form Detected"}),e.jsx("dd",{className:"text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.has_login_form?"bg-danger-100 text-danger-800":"bg-gray-100 text-gray-800"}`,children:s.has_login_form?"Yes":"No"})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Payment Form Detected"}),e.jsx("dd",{className:"text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.has_payment_form?"bg-danger-100 text-danger-800":"bg-gray-100 text-gray-800"}`,children:s.has_payment_form?"Yes":"No"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"External Verification"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"PhishTank"}),e.jsx("dd",{className:`text-sm font-medium ${s.in_phishtank?"text-danger-600":"text-gray-400"}`,children:s.in_phishtank?"Listed":"Not Listed"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"OpenPhish"}),e.jsx("dd",{className:`text-sm font-medium ${s.in_openphish?"text-danger-600":"text-gray-400"}`,children:s.in_openphish?"Listed":"Not Listed"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"URLhaus"}),e.jsx("dd",{className:`text-sm font-medium ${s.in_urlhaus?"text-danger-600":"text-gray-400"}`,children:s.in_urlhaus?"Listed":"Not Listed"})]})]})]})]}),s.screenshot_path&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Screenshot"}),e.jsx("img",{src:x(s.id),alt:"Phishing site screenshot",className:"w-full border border-gray-200 rounded-lg",onError:t=>{t.target.style.display="none",t.target.nextSibling.style.display="flex"}}),e.jsx("div",{className:"hidden w-full h-64 border border-gray-200 rounded-lg bg-gray-100 items-center justify-center flex-col",style:{display:"none"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-gray-500 mb-2",children:"Screenshot Unavailable"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Domain: ",s.phishing_domain]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Time: ",new Date(s.detected_at).toLocaleString()]})]})})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Detection not found"})})}export{U as default};
