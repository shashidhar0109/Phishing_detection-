import{j as e}from"./index-Cu6ENgEm.js";import{r as y}from"./vendor-BKU87Gzz.js";import{f as G,a as H,b as z,g as B,d as V}from"./api-C7L67YgP.js";import{b as U,A as F,T as $,c as N,L as J,d as K,P as W,a as X,e as Y,F as q,f as Q,g as Z,h as ee,i as te,E as se,j as ae,k as re}from"./icons-D5GPftki.js";import{R as ie}from"./RiskBadge-q8xUSvnq.js";import{a as D,f as C,p as A,b as ne}from"./utils-yGI3YnzF.js";import{R as L,A as oe,C as M,X as E,Y as I,T as P,a as le,B as ce,L as de,b as O}from"./charts-AhyWdGIE.js";import{b as xe}from"./router-S2BREDmH.js";function me({stats:t}){if(!t)return null;const l=[{title:"Total CSE Domains",value:t.total_cse_domains,icon:U,color:"text-primary-600",bgColor:"bg-primary-100",subtitle:`${t.detections_today} `},{title:"Phishing Detected",value:t.total_phishing_detected,icon:F,color:"text-red-600",bgColor:"bg-red-100",subtitle:`${t.detections_today} today`},{title:"High Risk",value:t.high_risk_count,icon:$,color:"text-orange-600",bgColor:"bg-orange-100",subtitle:`${t.detections_today} `},{title:"Monitoring Status",value:t.active_monitoring?"Active":"Inactive",icon:N,color:t.active_monitoring?"text-green-600":"text-gray-500",bgColor:t.active_monitoring?"bg-green-100":"bg-gray-100",subtitle:`${t.detections_this_week} this week`}];return e.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:l.map((c,r)=>e.jsx("div",{className:"bg-white shadow rounded-xl border border-gray-100 transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex items-center gap-4 p-6",children:[e.jsx("div",{className:`flex items-center justify-center h-12 w-12 rounded-lg ${c.bgColor}`,children:e.jsx(c.icon,{className:`h-6 w-6 ${c.color}`})}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:c.title}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:c.value}),c.subtitle&&e.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:c.subtitle})]})]})},r))})}const T="http://localhost:8001";function ge(){const[t,l]=y.useState({worker_running:!1,beat_running:!1,monitoring_active:!1}),[c,r]=y.useState(!1),[b,i]=y.useState("");y.useEffect(()=>{p();const s=setInterval(p,12e4);return()=>clearInterval(s)},[]);const p=async()=>{try{const s=await D.get(`${T}/api/monitoring/status`);l(s.data)}catch(s){console.error("Failed to fetch monitoring status:",s)}},n=async()=>{r(!0),i("");try{const s=await D.post(`${T}/api/monitoring/start`);s.data.success?(i("✅ Monitoring started successfully!"),await p()):i(`❌ ${s.data.message}`)}catch(s){i(`❌ Failed to start monitoring: ${s.message}`)}r(!1),setTimeout(()=>i(""),5e3)},m=async()=>{r(!0),i("");try{const s=await D.post(`${T}/api/monitoring/stop`);i("✅ Monitoring stopped"),await p()}catch(s){i(`❌ Failed to stop monitoring: ${s.message}`)}r(!1),setTimeout(()=>i(""),5e3)};return e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-primary-500",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${t.monitoring_active?"bg-success-100":"bg-gray-100"}`,children:e.jsx(N,{className:`h-6 w-6 ${t.monitoring_active?"text-success-600":"text-gray-400"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Background Monitoring"}),e.jsx("p",{className:"text-sm text-gray-500",children:t.monitoring_active?e.jsx("span",{className:"text-success-600 font-medium",children:"● Active - Scanning every 15 minutes"}):e.jsx("span",{className:"text-gray-500",children:"○ Inactive - Manual mode"})})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:c?e.jsxs("button",{disabled:!0,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-400 cursor-not-allowed",children:[e.jsx(J,{className:"h-5 w-5 mr-2 animate-spin"}),"Processing..."]}):t.monitoring_active?e.jsxs("button",{onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-danger-600 hover:bg-danger-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-danger-500",children:[e.jsx(K,{className:"h-5 w-5 mr-2"}),"Stop Monitoring"]}):e.jsxs("button",{onClick:n,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-success-600 hover:bg-success-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-success-500",children:[e.jsx(W,{className:"h-5 w-5 mr-2"}),"Start Monitoring"]})})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Worker:"}),e.jsx("span",{className:`font-medium ${t.worker_running?"text-success-600":"text-gray-400"}`,children:t.worker_running?"● Running":"○ Stopped"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Scheduler:"}),e.jsx("span",{className:`font-medium ${t.beat_running?"text-success-600":"text-gray-400"}`,children:t.beat_running?"● Running":"○ Stopped"})]})]})}),b&&e.jsx("div",{className:"mt-4 p-3 rounded-md bg-primary-50 border border-primary-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(X,{className:"h-5 w-5 text-primary-600 mr-2"}),e.jsx("p",{className:"text-sm text-primary-800",children:b})]})}),!t.monitoring_active&&!b&&e.jsx("div",{className:"mt-4 p-3 rounded-md bg-gray-50 border border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"Note:"})," Starting monitoring will automatically scan for phishing variations of all CSE domains every 15 minutes. Stop it when not needed to save resources."]})})]})}function he({stats:t,detections:l}){const r=(()=>{if(!l||!Array.isArray(l)||l.length===0)return[];const n=[...new Set(l.map(s=>C(A(s.detected_at),"yyyy-MM-dd")))].sort();return n.length===0?[]:n.map(s=>{const o=A(s),g=Array.isArray(l)?l.filter(h=>C(A(h.detected_at),"yyyy-MM-dd")===s).length:0;return{date:C(o,"MMM dd"),fullDate:s,detections:g}})})(),b=r.length>0&&r.some(n=>n.detections>0),i=[{risk:"High",count:(t==null?void 0:t.high_risk_count)||0,fill:"#ef4444"},{risk:"Medium",count:(t==null?void 0:t.medium_risk_count)||0,fill:"#f59e0b"},{risk:"Low",count:(t==null?void 0:t.low_risk_count)||0,fill:"#22c55e"}],p=i.some(n=>n.count>0);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx($,{className:"h-5 w-5 text-primary-600 dark:text-primary-400 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Detection Trend (All Time)"})]}),b?e.jsx(L,{width:"100%",height:250,children:e.jsxs(oe,{data:r,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorDetections",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#0ea5e9",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#0ea5e9",stopOpacity:0})]})}),e.jsx(M,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(E,{dataKey:"date",stroke:"#6b7280"}),e.jsx(I,{stroke:"#6b7280",allowDecimals:!1}),e.jsx(P,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(le,{type:"monotone",dataKey:"detections",stroke:"#0ea5e9",fillOpacity:1,fill:"url(#colorDetections)"})]})}):e.jsx("div",{className:"flex items-center justify-center h-[250px] text-gray-500 dark:text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx($,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),e.jsx("p",{children:"No detection data available yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Start monitoring CSE domains to see trends"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(N,{className:"h-5 w-5 text-primary-600 dark:text-primary-400 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Risk Distribution"})]}),p?e.jsx(L,{width:"100%",height:250,children:e.jsxs(ce,{data:i,children:[e.jsx(M,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(E,{dataKey:"risk",stroke:"#6b7280"}),e.jsx(I,{stroke:"#6b7280",allowDecimals:!1}),e.jsx(P,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(de,{}),e.jsx(O,{dataKey:"count",fill:"#0ea5e9",radius:[8,8,0,0],children:i.map((n,m)=>e.jsx(O,{fill:n.fill},`cell-${m}`))})]})}):e.jsx("div",{className:"flex items-center justify-center h-[250px] text-gray-500 dark:text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(N,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),e.jsx("p",{children:"No risk data available yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Detections will appear here by risk level"})]})})]})]})}function ye({data:t,filename:l="phishing-detections"}){const[c,r]=y.useState(!1),b=()=>{var h,d;if(!t||t.length===0){(h=window.showToast)==null||h.call(window,"No data to export","error");return}const m=[["Phishing Domain","Legitimate Domain","Risk Level","Risk Score","Variation Type","Organization","Country","Detected At"].join(","),...t.map(x=>[x.phishing_domain,x.legitimate_domain||"",x.risk_level,x.risk_score,x.variation_type||"",x.organization_name||"",x.country||"",x.detected_at].map(u=>`"${u}"`).join(","))].join(`
`),s=new Blob([m],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),g=URL.createObjectURL(s);o.setAttribute("href",g),o.setAttribute("download",`${l}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),(d=window.showToast)==null||d.call(window,"Data exported successfully","success"),r(!1)},i=()=>{var g,h;if(!t||t.length===0){(g=window.showToast)==null||g.call(window,"No data to export","error");return}const n=JSON.stringify(t,null,2),m=new Blob([n],{type:"application/json"}),s=document.createElement("a"),o=URL.createObjectURL(m);s.setAttribute("href",o),s.setAttribute("download",`${l}.json`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),(h=window.showToast)==null||h.call(window,"Data exported successfully","success"),r(!1)},p=async()=>{var n,m,s,o;if(!t||t.length===0){(n=window.showToast)==null||n.call(window,"No data to export","error");return}(m=window.showToast)==null||m.call(window,"Generating PS-02 submission package...","info"),r(!1);try{const h=await fetch("http://localhost:8001/api/export/ps02-submission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({application_id:"AIGR-108366",participant_id:"AIGR-S82274"})});if(!h.ok){const k=await h.text();throw new Error(`Server error: ${h.status} - ${k}`)}const d=await h.blob(),x=URL.createObjectURL(d),u=document.createElement("a");u.href=x,u.download="PS-02_AIGR-108366_Submission.zip",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(x),(s=window.showToast)==null||s.call(window,"PS-02 submission package generated successfully!","success")}catch(g){console.error("Export error:",g),(o=window.showToast)==null||o.call(window,`Failed to generate submission package: ${g.message}`,"error")}};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>r(!c),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Export Data"]}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>r(!1)}),e.jsx("div",{className:"absolute right-0 mt-2 w-64 rounded-lg shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 z-20",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:b,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx(q,{className:"h-4 w-4 mr-3 text-green-600"}),"Export as CSV"]}),e.jsxs("button",{onClick:i,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx(Q,{className:"h-4 w-4 mr-3 text-blue-600"}),"Export as JSON"]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),e.jsxs("button",{onClick:p,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx(Z,{className:"h-4 w-4 mr-3 text-purple-600"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-medium",children:"PS-02 Submission"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"AI Grand Challenge"})]})]})]})})]})]})}function _e(){const t=xe(),[l,c]=y.useState([]),[r,b]=y.useState([]),[i,p]=y.useState(null),[n,m]=y.useState(!0),[s,o]=y.useState("all"),[g,h]=y.useState(""),[d,x]=y.useState(null);y.useEffect(()=>{u();const a=setInterval(u,18e5);return()=>clearInterval(a)},[s]);const u=async()=>{try{const a={};s!=="all"&&(a.risk_level=s);const[f,j,v]=await Promise.all([G(a),H(),z()]),_=Array.isArray(f==null?void 0:f.data)?f.data:[],S=Array.isArray(j==null?void 0:j.data)?j.data:[],R=v&&typeof v.data=="object"?v.data:null;console.log("Loaded data:",{detections:_.length,trends:S.length,stats:R,detectionsType:typeof _,trendsType:typeof S}),c(_),b(S),p(R),m(!1)}catch(a){console.error("Failed to load data:",a),c([]),b([]),p(null),m(!1)}},k=async a=>{var f,j;if(window.confirm("Are you sure you want to delete this phishing detection?"))try{await V(a),u(),(f=window.showToast)==null||f.call(window,"Detection deleted successfully","success")}catch(v){console.error("Failed to delete detection:",v),(j=window.showToast)==null||j.call(window,"Failed to delete detection","error")}},w=(Array.isArray(l)?l:[]).filter(a=>!a||typeof a!="object"?!1:(a.phishing_domain||"").toLowerCase().includes(g.toLowerCase())||(a.legitimate_domain||"").toLowerCase().includes(g.toLowerCase()));return n?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx(me,{stats:i}),e.jsx(he,{stats:i,detections:r}),e.jsx(ge,{}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${s==="all"?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"All"}),e.jsx("button",{onClick:()=>o("HIGH"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${s==="HIGH"?"bg-danger-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"High Risk"}),e.jsx("button",{onClick:()=>o("MEDIUM"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${s==="MEDIUM"?"bg-warning-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"Medium Risk"}),e.jsx("button",{onClick:()=>o("LOW"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${s==="LOW"?"bg-success-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"Low Risk"}),e.jsx(ye,{data:w,filename:"phishing-detections"})]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"Search domains...",value:g,onChange:a=>h(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors"})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Recent Phishing Detections"}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[w.length," ",w.length===1?"detection":"detections"]})]})}),e.jsx("div",{className:"overflow-x-auto max-h-[600px] overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider bg-gray-50 dark:bg-gray-900",children:"Risk"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider bg-gray-50 dark:bg-gray-900",children:"Phishing Domain"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider bg-gray-50 dark:bg-gray-900",children:"Legitimate Domain"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider bg-gray-50 dark:bg-gray-900",children:"Detected"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider bg-gray-50 dark:bg-gray-900",children:"Country"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider bg-gray-50 dark:bg-gray-900",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:w.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:"No phishing detections found"})}):w.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(ie,{level:a.risk_level,score:a.risk_score})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"h-4 w-4 text-danger-500 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a.phishing_domain})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.variation_type})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-4 w-4 text-success-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.legitimate_domain||"Unknown"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.organization_name})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),ne(new Date(a.detected_at),{addSuffix:!0})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.country||"Unknown"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:f=>{f.preventDefault(),console.log("Navigating to detection:",a.id),t(`/detection/${a.id}`)},className:"text-primary-600 hover:text-primary-900 cursor-pointer",title:"View Details","aria-label":`View details for ${a.phishing_domain}`,children:e.jsx(se,{className:"h-5 w-5"})}),a.screenshot_path&&e.jsx("button",{onClick:()=>x(a),className:"text-purple-600 hover:text-purple-900",title:"View Screenshot","aria-label":`View screenshot for ${a.phishing_domain}`,children:e.jsx(ae,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>k(a.id),className:"text-danger-600 hover:text-danger-900",title:"Delete Detection","aria-label":`Delete detection for ${a.phishing_domain}`,children:e.jsx(re,{className:"h-5 w-5"})})]})})]},a.id))})]})})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:()=>x(null),children:e.jsxs("div",{className:"relative max-w-6xl max-h-full bg-white rounded-lg shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Screenshot: ",d.phishing_domain]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Risk: ",e.jsx("span",{className:`font-medium ${d.risk_level==="HIGH"?"text-danger-600":d.risk_level==="MEDIUM"?"text-warning-600":"text-success-600"}`,children:d.risk_level})," (",Math.round(d.risk_score),"/100)"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>x(null),className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:"Close"})})]}),e.jsxs("div",{className:"p-6 overflow-auto max-h-[80vh]",children:[e.jsx("img",{src:B(d.id),alt:`Screenshot of ${d.phishing_domain}`,className:"w-full border border-gray-300 rounded-lg",onClick:a=>a.stopPropagation(),onError:a=>{a.target.style.display="none",a.target.nextSibling.style.display="flex"}}),e.jsx("div",{className:"hidden w-full h-64 border border-gray-300 rounded-lg bg-gray-100 items-center justify-center flex-col",style:{display:"none"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-500 mb-2",children:"Screenshot Unavailable"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Domain: ",d.phishing_domain]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Time: ",new Date(d.detected_at).toLocaleString()]})]})})]})]})})]})}export{_e as default};
