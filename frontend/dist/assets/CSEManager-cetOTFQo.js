import{j as e}from"./index-Cu6ENgEm.js";import{r}from"./vendor-BKU87Gzz.js";import{c as X,e as Z,h as ee,i as se}from"./api-C7L67YgP.js";import{U as B,l as te,F as ae,R as ie,B as $,G as re,k as ne}from"./icons-D5GPftki.js";import"./router-S2BREDmH.js";import"./utils-yGI3YnzF.js";const oe=g=>{const s=g.toLowerCase();return s.includes("bank")||s.includes("sbi")||s.includes("hdfc")||s.includes("icici")||s.includes("pnb")||s.includes("bob")||s.includes("axis")||s.includes("kotak")||s.includes("yes")||s.includes("union")||s.includes("canara")||s.includes("indian")||s.includes("paytm")||s.includes("phonepe")||s.includes("gpay")||s.includes("paypal")||s.includes("razorpay")||s.includes("cashfree")?{sector:"BFSI",organization:"Banking/Financial Services"}:s.includes(".gov")||s.includes("nic")||s.includes("india")||s.includes("ministry")||s.includes("department")||s.includes("portal")?{sector:"Government",organization:"Government of India"}:s.includes("shop")||s.includes("store")||s.includes("market")||s.includes("amazon")||s.includes("flipkart")||s.includes("myntra")||s.includes("snapdeal")||s.includes("nykaa")||s.includes("zomato")||s.includes("swiggy")||s.includes("uber")||s.includes("ola")?{sector:"E-commerce",organization:"E-commerce Platform"}:s.includes("airtel")||s.includes("jio")||s.includes("vi")||s.includes("bsnl")||s.includes("vodafone")||s.includes("idea")?{sector:"Telecom",organization:"Telecom Service Provider"}:s.includes("health")||s.includes("medical")||s.includes("hospital")||s.includes("pharma")||s.includes("medicine")||s.includes("doctor")?{sector:"Healthcare",organization:"Healthcare Provider"}:s.includes("edu")||s.includes("university")||s.includes("college")||s.includes("school")||s.includes("institute")||s.includes("academy")?{sector:"Education",organization:"Educational Institution"}:s.includes("tech")||s.includes("software")||s.includes("it")||s.includes("digital")||s.includes("app")||s.includes("cloud")?{sector:"Technology",organization:"Technology Company"}:s.endsWith(".gov.in")||s.endsWith(".nic.in")?{sector:"Government",organization:"Government of India"}:s.endsWith(".edu")||s.endsWith(".ac.in")?{sector:"Education",organization:"Educational Institution"}:s.endsWith(".org")||s.endsWith(".org.in")?{sector:"Non-Profit",organization:"Non-Profit Organization"}:{sector:"Other",organization:"Unknown Organization"}};function ye(){const[g,s]=r.useState([]),[R,f]=r.useState(!0),[A,w]=r.useState(!1),[E,N]=r.useState(!1),[v,x]=r.useState(""),[T,L]=r.useState(!1),[P,n]=r.useState(""),[U,y]=r.useState(""),[h,V]=r.useState(0),[le,de]=r.useState(0),[W,G]=r.useState(!1),[o,S]=r.useState({sector:"",organization_name:"",domain:""});r.useEffect(()=>{l()},[]);const H=()=>{l(h)},q=async()=>{try{f(!0);const t=await fetch("http://localhost:8001/api/cse-domains/update-sectors",{method:"POST",headers:{"Content-Type":"application/json"}});if(t.ok){const a=await t.json();y(`âœ… ${a.message}`),l(h)}else n("âŒ Failed to update sectors")}catch(t){console.error("Failed to update sectors:",t),n("âŒ Failed to update sectors")}f(!1)},l=async(t=0)=>{try{f(!0);const a=await X({skip:t*50,limit:50}),d=Array.isArray(a==null?void 0:a.data)?a.data:[];s(d),V(t),G(d.length===50),f(!1)}catch(a){console.error("Failed to load domains:",a),s([]),f(!1)}},Q=async t=>{var a,d;t.preventDefault(),n(""),y("");try{await Z(o),y(`âœ… Successfully added ${o.domain} for monitoring!`),S({sector:"",organization_name:"",domain:""}),setTimeout(()=>{w(!1),y("")},2e3),l()}catch(p){console.error("Failed to add domain:",p);const i=((d=(a=p.response)==null?void 0:a.data)==null?void 0:d.detail)||p.message;i.includes("TYPOSQUATTING")||i.includes("typosquatting")||i.includes("PHISHING")||i.includes("malicious")?n(i):i.includes("already exists")||i.includes("already being monitored")?n("â„¹ï¸ This domain is already being monitored."):n(`âŒ ${i}`)}},Y=async t=>{if(window.confirm("Are you sure you want to remove this domain from monitoring?"))try{await se(t),l()}catch(a){console.error("Failed to delete domain:",a)}},J=async t=>{var d,p;const a=t.target.files[0];if(a){L(!0),x("Processing CSV file...");try{const b=(await a.text()).split(`
`),k=[];let M="",I="";if(!(b[1]||"").includes(","))for(let u=1;u<b.length;u++){const c=b[u].trim();if(!c||c.toLowerCase().includes("domain")||c.toLowerCase().includes("user"))continue;const{sector:_,organization:j}=oe(c);k.push({sector:_,organization_name:j,domain:c})}else for(let u=1;u<b.length;u++){const c=b[u].trim();if(!c)continue;const j=(c.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g)||[]).map(K=>K.replace(/^"|"$/g,"").trim()),z=j[0]||"",D=j[1]||"",F=j[2]||"";F&&(M=F),D&&(I=D),!(!z||z.toLowerCase().includes("domain"))&&k.push({sector:F||M||"Unknown",organization_name:D||I||"Unknown",domain:z})}x(`Uploading ${k.length} domains... This may take a few minutes for large files.`);const O=await ee(k),m=O.data;let C=`âœ… ${m.message||`Successfully added ${m.length||O.data.length} domains!`}`;C+=`

ðŸ“‹ Note: Domains are stored quickly without scanning. Domain classification and malicious detection will happen when you start monitoring.`,m.skipped_existing&&m.skipped_existing.length>0&&(C+=`

â„¹ï¸ Already monitoring: ${m.skipped_existing.join(", ")}`),x(C),(!m.skipped_malicious||m.skipped_malicious.length===0)&&setTimeout(()=>{x(""),N(!1)},3e3),l()}catch(i){console.error("Failed to upload CSV:",i),x(`âŒ Error: ${((p=(d=i.response)==null?void 0:d.data)==null?void 0:p.detail)||i.message}`)}finally{L(!1),t.target.value=""}}};return R?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"CSE Domain Manager"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage Critical Sector Entity domains for phishing monitoring"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{N(!E),w(!1)},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(B,{className:"h-5 w-5 mr-2"}),"Upload CSV"]}),e.jsxs("button",{onClick:()=>{w(!A),N(!1)},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(te,{className:"h-5 w-5 mr-2"}),"Add Domain"]})]})]}),A&&e.jsxs("form",{onSubmit:Q,className:"mt-6 border-t pt-6",children:[e.jsx("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"âš¡ Security Validation Active"}),e.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[e.jsx("p",{children:"The system will validate that the domain is:"}),e.jsxs("ul",{className:"list-disc list-inside mt-1 ml-2",children:[e.jsx("li",{children:"NOT listed in malicious domain databases"}),e.jsx("li",{children:"NOT using suspicious patterns or characteristics"}),e.jsx("li",{children:"A legitimate, registered domain"})]}),e.jsx("p",{className:"mt-2 font-medium",children:"Only verified legitimate domains can be added for monitoring."})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Sector"}),e.jsx("input",{type:"text",value:o.sector,onChange:t=>S({...o,sector:t.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organization Name"}),e.jsx("input",{type:"text",value:o.organization_name,onChange:t=>S({...o,organization_name:t.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Domain (without http://)"}),e.jsx("input",{type:"text",value:o.domain,onChange:t=>S({...o,domain:t.target.value}),placeholder:"example.com",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",required:!0})]})]}),P&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("pre",{className:"text-sm font-medium text-red-800 whitespace-pre-wrap font-sans",children:P})})]})}),U&&e.jsx("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:U})})]})}),e.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{w(!1),n(""),y("")},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700",children:"Add Domain"})]})]}),E&&e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border-2 border-dashed border-gray-300",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Upload CSV File"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"CSV format: Domain, Organization, Sector"}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".csv",onChange:J,disabled:T,className:"hidden"}),e.jsx("span",{className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:bg-gray-400",children:T?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Choose CSV File"]})})]})}),v&&e.jsx("div",{className:`mt-4 p-4 rounded-md ${v.startsWith("âœ…")?"bg-success-50 border border-success-200 text-success-800":v.startsWith("âŒ")?"bg-danger-50 border border-danger-200 text-danger-800":"bg-primary-50 border border-primary-200 text-primary-800"}`,children:e.jsx("pre",{className:"text-sm font-medium whitespace-pre-wrap font-sans",children:v})}),e.jsxs("div",{className:"mt-4 text-xs text-gray-500 text-left",children:[e.jsx("p",{className:"font-medium mb-2",children:"Supported CSV Formats:"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Format 1: Simple Domain List"}),e.jsx("pre",{className:"bg-white p-2 rounded border border-gray-200 overflow-x-auto",children:"Domain User Form div29.gent krausey.com satmathstats.com dyczzs.com"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Format 2: Multi-column CSV"}),e.jsx("pre",{className:"bg-white p-2 rounded border border-gray-200 overflow-x-auto",children:"Domain,Organization,Sector sbi.co.in,State Bank of India,BFSI onlinesbi.sbi,, sbicard.com,, icicibank.com,ICICI Bank,BFSI"})]}),e.jsxs("p",{className:"mt-2 text-gray-600",children:["â€¢ System automatically detects the format",e.jsx("br",{}),"â€¢ First row is treated as header and skipped",e.jsx("br",{}),'â€¢ For simple lists, Organization and Sector will be set to "Unknown"']})]})]})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>{N(!1),x("")},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Close"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Monitored Domains (Page ",h+1,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:H,className:"px-3 py-1 text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex items-center gap-1",children:[e.jsx(ie,{className:"w-4 h-4"}),"Refresh"]}),e.jsxs("button",{onClick:q,className:"px-3 py-1 text-sm bg-green-100 hover:bg-green-200 text-green-700 rounded flex items-center gap-1",children:[e.jsx($,{className:"w-4 h-4"}),"Fix Sectors"]}),e.jsx("button",{onClick:()=>l(h-1),disabled:h===0,className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded",children:"Previous"}),e.jsx("button",{onClick:()=>l(h+1),disabled:!W,className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded",children:"Next"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Domain"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Organization"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sector"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Added"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.isArray(g)&&g.length>0?g.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"h-5 w-5 text-primary-500 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.domain})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:t.organization_name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-primary-100 text-primary-800",children:t.sector})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.added_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>Y(t.id),className:"text-danger-600 hover:text-danger-900",children:e.jsx(ne,{className:"h-5 w-5"})})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500",children:"No domains found. Add a domain to get started."})})})]})})]})]})}export{ye as default};
